<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Административная панель - БНТП</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.11.3/main.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .stat-card {
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .sidebar {
            transition: all 0.3s ease;
        }
        .sidebar-collapsed {
            width: 80px;
        }
        .notification-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .activity-item {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .chart-container {
            position: relative;
            height: 300px;
        }
        .welcome-banner {
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0MCIgaGVpZ2h0PSIzMjAiIHZpZXdCb3g9IjAgMCAxNDQwIDMyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMTYwTDQ4IDEzOC43QzQzOC43IDExNy4zIDIyMi43IDc0LjcgMzIwIDc0LjdDNDE3LjMgNzQuNyA0MDAuMyAxMTcuMyA0ODAgMTM4LjdDNTU5LjcgMTYwIDYzOS4zIDEzOC43IDcyMCAxMTcuM0M4MDAuNyA5NiA4ODAuNyA3NC43IDk2MCA5NkMxMDM5LjMgMTE3LjMgMTExOS4zIDE4MS4zIDEyMDAgMjAyLjdDMTI4MC43IDIyNCAxMzYwLjcgMjAyLjcgMTQ0MCAxODEuM0wxNDQwIDMyMEwxMzkyIDMyMEMxMzQ0IDMyMCAxMjk2IDMyMCAxMjQ4IDMyMEMxMjAwIDMyMCAxMTUyIDMyMCAxMTA0IDMyMEMxMDU2IDMyMCAxMDA4IDMyMCA5NjAgMzIwQzkxMiAzMjAgODY0IDMyMCA4MTYgMzIwQzc2OCAzMjAgNzIwIDMyMCA2NzIgMzIwQzYyNCAzMjAgNTc2IDMyMCA1MjggMzIwQzQ4MCAzMjAgNDMyIDMyMCAzODQgMzIwQzMzNiAzMjAgMjg4IDMyMCAyNDAgMzIwQzE5MiAzMjAgMTQ0IDMyMCA5NiAzMjBDNDggMzIwIDI0IDMyMCAwIDMyMEwwIDE2MFoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl8xXzIpIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMV8yIiB4MT0iMCIgeTE9IjE2MCIgeDI9IjE0NDAiIHkyPSIxNjAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzY2N0VFQSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM3NjRCQTIiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4=') no-repeat bottom;
            background-size: cover;
        }
        .calendar-container {
            min-height: 500px;
        }
        .fc-event {
            cursor: pointer;
        }
        .conflict-booking {
            background-color: #fecaca !important;
            border-color: #dc2626 !important;
        }
        .pending-booking {
            background-color: #fef3c7 !important;
            border-color: #d97706 !important;
        }
        .approved-booking {
            background-color: #d1fae5 !important;
            border-color: #10b981 !important;
        }
    </style>
</head>
<body class="bg-gray-50">

<!-- Sidebar -->
<div id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-white shadow-lg z-30 sidebar">
    <div class="p-6">
        <div class="flex items-center space-x-3 mb-8">
            <div class="w-10 h-10 gradient-bg rounded-lg flex items-center justify-center text-white">
                <i class="fas fa-cube"></i>
            </div>
            <h1 class="text-xl font-bold gradient-text">БНТП Админ</h1>
        </div>

        <nav class="space-y-2">
            <button onclick="switchTab('overview')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-purple-50 text-gray-700 flex items-center space-x-3 transition bg-purple-100 text-purple-700">
                <i class="fas fa-home w-5"></i>
                <span class="sidebar-text">Обзор</span>
            </button>
            <button onclick="switchTab('bookings')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-purple-50 text-gray-700 flex items-center space-x-3 transition">
                <i class="fas fa-calendar-check w-5"></i>
                <span class="sidebar-text">Бронирования</span>
            </button>
            <button onclick="switchTab('announcements')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-purple-50 text-gray-700 flex items-center space-x-3 transition">
                <i class="fas fa-bullhorn w-5"></i>
                <span class="sidebar-text">Объявления</span>
            </button>
            <button onclick="switchTab('users')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-purple-50 text-gray-700 flex items-center space-x-3 transition">
                <i class="fas fa-users w-5"></i>
                <span class="sidebar-text">Пользователи</span>
            </button>
            <button onclick="switchTab('analytics')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-purple-50 text-gray-700 flex items-center space-x-3 transition">
                <i class="fas fa-chart-bar w-5"></i>
                <span class="sidebar-text">Аналитика</span>
            </button>
        </nav>
    </div>

    <div class="absolute bottom-0 left-0 right-0 p-6">
        <button onclick="toggleSidebar()" class="w-full text-center text-gray-500 hover:text-gray-700">
            <i class="fas fa-chevron-left" id="sidebarToggleIcon"></i>
        </button>
    </div>
</div>

<!-- Main Content -->
<div class="ml-64 transition-all" id="mainContent">
    <!-- Header -->
    <nav class="bg-white shadow-sm p-4 sticky top-0 z-20">
        <div class="flex justify-between items-center">
            <h2 class="text-2xl font-bold text-gray-800" id="pageTitle">Административная панель</h2>
            <div class="flex items-center space-x-4">
                <!-- Notifications -->
                <div class="relative">
                    <button onclick="toggleNotifications()" class="text-gray-600 hover:text-gray-800 relative">
                        <i class="fas fa-bell text-xl"></i>
                        <span id="notificationBadge" class="notification-badge absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                    </button>

                    <!-- Notifications dropdown -->
                    <div id="notificationsDropdown" class="absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border hidden z-50">
                        <div class="p-4 border-b">
                            <h3 class="font-semibold text-gray-800">Уведомления</h3>
                        </div>
                        <div id="notificationsList" class="max-h-64 overflow-y-auto">
                            <!-- Notifications will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- User Menu -->
                <div class="flex items-center space-x-3">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=667eea&color=fff" alt="Avatar" class="w-10 h-10 rounded-full">
                    <div>
                        <p class="text-sm font-medium text-gray-700" id="userName">Администратор</p>
                        <p class="text-xs text-gray-500" id="userRole">Администратор</p>
                    </div>
                    <button onclick="logout()" class="ml-3 text-red-500 hover:text-red-600">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="p-6">
        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <!-- Welcome Banner -->
            <div class="welcome-banner gradient-bg rounded-2xl p-8 mb-8 text-white">
                <h1 class="text-3xl font-bold mb-2">Добро пожаловать в административную панель!</h1>
                <p class="text-lg opacity-90">Управляйте технопарком эффективно и удобно</p>
                <div class="mt-6 flex space-x-4">
                    <button onclick="switchTab('bookings')" class="bg-white text-purple-600 px-6 py-2 rounded-lg font-medium hover:bg-gray-100 transition">
                        <i class="fas fa-calendar-check mr-2"></i>Управление бронированиями
                    </button>
                    <button onclick="switchTab('announcements')" class="bg-purple-700 text-white px-6 py-2 rounded-lg font-medium hover:bg-purple-800 transition">
                        <i class="fas fa-bullhorn mr-2"></i>Создать объявление
                    </button>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card p-6 rounded-xl">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-sm text-gray-600">Всего пользователей</p>
                            <p class="text-3xl font-bold text-gray-800" id="totalUsers">47</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-purple-600"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                        <span class="text-green-500">12%</span>
                        <span class="text-gray-500 ml-1">за месяц</span>
                    </div>
                </div>

                <div class="stat-card p-6 rounded-xl">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-sm text-gray-600">Активные брони</p>
                            <p class="text-3xl font-bold text-gray-800" id="activeBookings">12</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-calendar-check text-blue-600"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                        <span class="text-green-500">8%</span>
                        <span class="text-gray-500 ml-1">за неделю</span>
                    </div>
                </div>

                <div class="stat-card p-6 rounded-xl">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-sm text-gray-600">Объявления</p>
                            <p class="text-3xl font-bold text-gray-800" id="totalAnnouncements">8</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-bullhorn text-green-600"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-minus text-gray-500 mr-1"></i>
                        <span class="text-gray-500">Без изменений</span>
                    </div>
                </div>

                <div class="stat-card p-6 rounded-xl">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-sm text-gray-600">Ожидают одобрения</p>
                            <p class="text-3xl font-bold text-gray-800" id="pendingApprovals">3</p>
                        </div>
                        <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-clock text-orange-600"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-exclamation-circle text-orange-500 mr-1"></i>
                        <span class="text-orange-500">Требует внимания</span>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Загруженность помещений</h3>
                    <div class="chart-container">
                        <canvas id="roomOccupancyChart"></canvas>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Типы пользователей</h3>
                    <div class="chart-container">
                        <canvas id="usersChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">Последняя активность</h3>
                <div class="space-y-4" id="activityList">
                    <!-- Activity items will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Bookings Tab -->
        <div id="bookings" class="tab-content">
            <div class="bg-white rounded-xl shadow-sm p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Управление бронированием</h2>
                    <div class="flex space-x-4">
                        <select class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            <option>Все типы помещений</option>
                            <option>Переговорка</option>
                            <option>Конференц-зал</option>
                            <option>Выставочный зал</option>
                        </select>
                        <select class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            <option>Все статусы</option>
                            <option>Ожидает</option>
                            <option>Подтверждено</option>
                            <option>Отклонено</option>
                            <option>Конфликт</option>
                        </select>
                    </div>
                </div>

                <!-- Уведомление о конфликтах -->
                <div id="conflictAlert" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
                        <span class="font-medium text-red-800">Обнаружены конфликты бронирования!</span>
                    </div>
                    <p class="text-red-700 mt-1">Несколько заявок поданы на одно время. Требуется разрешение конфликта.</p>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                        <tr class="text-left border-b">
                            <th class="pb-3 font-medium text-gray-700">Помещение</th>
                            <th class="pb-3 font-medium text-gray-700">Дата и время</th>
                            <th class="pb-3 font-medium text-gray-700">Заявитель</th>
                            <th class="pb-3 font-medium text-gray-700">Подача заявки</th>
                            <th class="pb-3 font-medium text-gray-700">Статус</th>
                            <th class="pb-3 font-medium text-gray-700">Действия</th>
                        </tr>
                        </thead>
                        <tbody id="bookingsList">
                        <!-- Bookings will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Announcements Tab -->
        <div id="announcements" class="tab-content">
            <div class="bg-white rounded-xl shadow-sm p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Управление объявлениями</h2>
                    <button onclick="openAnnouncementModal()" class="gradient-bg text-white px-6 py-2 rounded-lg hover:opacity-90 transition">
                        <i class="fas fa-plus mr-2"></i>Новое объявление
                    </button>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="announcementsList">
                    <!-- Announcements will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <div class="grid lg:grid-cols-2 gap-6">
                <!-- Create User Section -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-user-plus mr-3 text-purple-600"></i>
                        Создание пользователя
                    </h3>

                    <form id="createUserForm" class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Логин</label>
                                <input type="text" name="username" required class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Пароль</label>
                                <input type="password" name="password" required class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" name="email" required class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Компания</label>
                                <input type="text" name="company" required class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Телефон</label>
                                <input type="tel" name="phone" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Контактное лицо</label>
                                <input type="text" name="contactPerson" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Роль</label>
                                <select name="role" required class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                                    <option value="">Выберите роль</option>
                                    <option value="RESIDENT">Резидент</option>
                                    <option value="USER">Пользователь</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="w-full gradient-bg text-white py-3 rounded-lg hover:opacity-90 transition">
                            <i class="fas fa-user-plus mr-2"></i>Создать пользователя
                        </button>
                    </form>
                </div>

                <!-- Users Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-users-cog mr-3 text-purple-600"></i>
                        Управление пользователями
                    </h3>

                    <div class="space-y-4" id="usersList">
                        <!-- Users will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Pending Users -->
            <div class="mt-6 bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-user-clock mr-3 text-purple-600"></i>
                    Пользователи ожидающие одобрения
                </h3>
                <div class="space-y-4" id="pendingUsersList">
                    <!-- Pending users will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="grid lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Статистика бронирований по месяцам</h3>
                    <div class="chart-container">
                        <canvas id="monthlyBookingsChart"></canvas>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Популярность помещений</h3>
                    <div class="chart-container">
                        <canvas id="roomPopularityChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-lg font-semibold mb-4">Подробная статистика</h3>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="text-center p-4 bg-blue-50 rounded-lg">
                        <i class="fas fa-calendar-day text-3xl text-blue-600 mb-2"></i>
                        <p class="text-2xl font-bold text-blue-800">156</p>
                        <p class="text-sm text-blue-600">Бронирований в этом месяце</p>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-lg">
                        <i class="fas fa-percentage text-3xl text-green-600 mb-2"></i>
                        <p class="text-2xl font-bold text-green-800">87%</p>
                        <p class="text-sm text-green-600">Средняя загруженность</p>
                    </div>
                    <div class="text-center p-4 bg-purple-50 rounded-lg">
                        <i class="fas fa-clock text-3xl text-purple-600 mb-2"></i>
                        <p class="text-2xl font-bold text-purple-800">2.5ч</p>
                        <p class="text-sm text-purple-600">Средняя длительность</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- User Credentials Edit Modal -->
<div id="userEditModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-white p-8 rounded-xl max-w-md w-full mx-4">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold">Изменить данные пользователя</h3>
            <button onclick="closeUserEditModal()" class="text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>

        <form id="userEditForm" class="space-y-4">
            <input type="hidden" id="editUserId" name="userId">

            <div>
                <label class="block text-sm font-medium mb-2">Новый логин</label>
                <input type="text" id="editUsername" name="username" required
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
            </div>

            <div>
                <label class="block text-sm font-medium mb-2">Новый пароль (оставьте пустым, если не хотите менять)</label>
                <input type="password" id="editPassword" name="password"
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
            </div>

            <div class="flex justify-end space-x-3">
                <button type="button" onclick="closeUserEditModal()"
                        class="px-6 py-3 text-gray-600 hover:bg-gray-100 rounded-lg transition">
                    Отмена
                </button>
                <button type="submit"
                        class="px-6 py-3 gradient-bg text-white rounded-lg hover:opacity-90 transition">
                    Сохранить изменения
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Announcement Modal -->
<div id="announcementModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-white p-8 rounded-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold">Новое объявление</h3>
            <button onclick="closeAnnouncementModal()" class="text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>

        <form id="announcementForm" class="space-y-6">
            <div>
                <label class="block text-sm font-medium mb-2">Заголовок</label>
                <input type="text" name="title" required placeholder="Введите заголовок объявления"
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
            </div>

            <div>
                <label class="block text-sm font-medium mb-2">Тип объявления</label>
                <div class="grid grid-cols-3 gap-3">
                    <label class="relative">
                        <input type="radio" name="type" value="NEWS" required class="sr-only peer">
                        <div class="p-4 border rounded-lg cursor-pointer hover:bg-gray-50 peer-checked:border-purple-500 peer-checked:bg-purple-50">
                            <i class="fas fa-newspaper text-2xl text-blue-600 mb-2"></i>
                            <p class="font-medium">Новости</p>
                        </div>
                    </label>
                    <label class="relative">
                        <input type="radio" name="type" value="VACANCY" required class="sr-only peer">
                        <div class="p-4 border rounded-lg cursor-pointer hover:bg-gray-50 peer-checked:border-purple-500 peer-checked:bg-purple-50">
                            <i class="fas fa-briefcase text-2xl text-green-600 mb-2"></i>
                            <p class="font-medium">Вакансия</p>
                        </div>
                    </label>
                    <label class="relative">
                        <input type="radio" name="type" value="EVENT" required class="sr-only peer">
                        <div class="p-4 border rounded-lg cursor-pointer hover:bg-gray-50 peer-checked:border-purple-500 peer-checked:bg-purple-50">
                            <i class="fas fa-calendar-alt text-2xl text-orange-600 mb-2"></i>
                            <p class="font-medium">Мероприятие</p>
                        </div>
                    </label>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium mb-2">Содержание</label>
                <textarea name="content" required rows="6" placeholder="Введите текст объявления"
                          class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"></textarea>
            </div>

            <div class="flex justify-end space-x-3">
                <button type="button" onclick="closeAnnouncementModal()"
                        class="px-6 py-3 text-gray-600 hover:bg-gray-100 rounded-lg transition">
                    Отмена
                </button>
                <button type="submit"
                        class="px-6 py-3 gradient-bg text-white rounded-lg hover:opacity-90 transition">
                    <i class="fas fa-paper-plane mr-2"></i>Создать объявление
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    // Global variables
    let currentTab = 'overview';

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', function() {
        initializeCharts();
        loadDashboardData();
        loadNotifications();
        switchTab('overview');
    });

    function switchTab(tabId) {
        // Update page title
        const titles = {
            'overview': 'Административная панель',
            'bookings': 'Управление бронированиями',
            'announcements': 'Управление объявлениями',
            'users': 'Управление пользователями',
            'analytics': 'Аналитика'
        };
        document.getElementById('pageTitle').textContent = titles[tabId] || 'Административная панель';

        // Hide all tabs
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });

        // Show selected tab
        document.getElementById(tabId).classList.add('active');

        // Update sidebar active state
        document.querySelectorAll('nav button').forEach(btn => {
            btn.classList.remove('bg-purple-100', 'text-purple-700');
            btn.classList.add('text-gray-700');
        });
        event.currentTarget.classList.add('bg-purple-100', 'text-purple-700');
        event.currentTarget.classList.remove('text-gray-700');

        currentTab = tabId;

        // Load tab data
        loadTabData(tabId);
    }

    function loadTabData(tabId) {
        switch(tabId) {
            case 'bookings':
                loadBookings();
                break;
            case 'announcements':
                loadAnnouncements();
                break;
            case 'users':
                loadPendingUsers();
                loadUsers();
                break;
            case 'analytics':
                loadAnalytics();
                break;
        }
    }

    function loadBookings() {
        const tbody = document.getElementById('bookingsList');
        if (tbody) {
            tbody.innerHTML = '<tr><td colspan="6" class="text-center py-4">Загрузка...</td></tr>';

            // Simulate loading bookings data
            setTimeout(() => {
                tbody.innerHTML = `
                    <tr class="border-b hover:bg-gray-50 conflict-booking">
                        <td class="py-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-exclamation-triangle text-red-600"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Конференц-зал</p>
                                    <p class="text-sm text-gray-500">108 м², до 80 мест</p>
                                </div>
                            </div>
                        </td>
                        <td class="py-4">
                            <p class="font-medium">15.12.2024</p>
                            <p class="text-sm text-gray-500">10:00 - 12:00</p>
                        </td>
                        <td class="py-4">
                            <p class="font-medium">ООО "ТехноСофт"</p>
                            <p class="text-sm text-gray-500">Иванов И.И.</p>
                        </td>
                        <td class="py-4">
                            <p class="font-medium">14.12.2024</p>
                            <p class="text-sm text-gray-500">15:30</p>
                        </td>
                        <td class="py-4">
                            <span class="px-3 py-1 text-xs rounded-full bg-red-100 text-red-800">Конфликт</span>
                        </td>
                        <td class="py-4">
                            <div class="flex space-x-2">
                                <button onclick="approveBooking(1)" class="text-green-600 hover:bg-green-50 p-2 rounded">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button onclick="rejectBooking(1)" class="text-red-600 hover:bg-red-50 p-2 rounded">
                                    <i class="fas fa-times"></i>
                                </button>
                                <button class="text-gray-600 hover:bg-gray-100 p-2 rounded">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 pending-booking">
                        <td class="py-4">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-clock text-yellow-600"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Переговорка</p>
                                    <p class="text-sm text-gray-500">55 м², до 15 мест</p>
                                </div>
                            </div>
                        </td>
                        <td class="py-4">
                            <p class="font-medium">16.12.2024</p>
                            <p class="text-sm text-gray-500">14:00 - 16:00</p>
                        </td>
                        <td class="py-4">
                            <p class="font-medium">ИП Петров</p>
                            <p class="text-sm text-gray-500">petrov@example.com</p>
                        </td>
                        <td class="py-4">
                            <p class="font-medium">15.12.2024</p>
                            <p class="text-sm text-gray-500">09:15</p>
                        </td>
                        <td class="py-4">
                            <span class="px-3 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800">Ожидает</span>
                        </td>
                        <td class="py-4">
                            <div class="flex space-x-2">
                                <button onclick="approveBooking(2)" class="text-green-600 hover:bg-green-50 p-2 rounded">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button onclick="rejectBooking(2)" class="text-red-600 hover:bg-red-50 p-2 rounded">
                                    <i class="fas fa-times"></i>
                                </button>
                                <button class="text-gray-600 hover:bg-gray-100 p-2 rounded">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }, 500);
        }
    }

    function loadAnnouncements() {
        fetch('/api/announcements')
            .then(response => response.json())
            .then(data => {
                const container = document.getElementById('announcementsList');
                container.innerHTML = '';

                // Add pending announcements first
                const pendingPlaceholder = document.createElement('div');
                pendingPlaceholder.className = 'col-span-full mb-6';
                pendingPlaceholder.innerHTML = `
                    <h3 class="text-lg font-semibold mb-4">Ожидающие публикации</h3>
                    <div class="border rounded-lg p-4 bg-yellow-50">
                        <p class="text-yellow-800">Нет объявлений ожидающих публикации</p>
                    </div>
                `;
                container.appendChild(pendingPlaceholder);

                data.forEach(announcement => {
                    const div = document.createElement('div');
                    div.className = 'border rounded-xl p-6 hover:shadow-lg transition';

                    const typeColors = {
                        'NEWS': 'blue',
                        'VACANCY': 'green',
                        'EVENT': 'orange'
                    };
                    const color = typeColors[announcement.type] || 'gray';

                    div.innerHTML = `
                        <div class="flex justify-between items-start mb-4">
                            <span class="px-3 py-1 text-xs rounded-full bg-${color}-100 text-${color}-800">
                                ${announcement.type === 'NEWS' ? 'Новости' :
                        announcement.type === 'VACANCY' ? 'Вакансия' : 'Мероприятие'}
                            </span>
                            <button class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-ellipsis-v"></i>
                            </button>
                        </div>
                        <h3 class="font-semibold text-lg mb-2">${announcement.title}</h3>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3">${announcement.content.substring(0, 150)}...</p>
                        <div class="flex justify-between items-center">
                            <span class="text-xs text-gray-500">${new Date(announcement.createdAt).toLocaleDateString('ru-RU')}</span>
                            <div class="flex space-x-2">
                                ${!announcement.published ?
                        `<button onclick="publishAnnouncement(${announcement.id})" class="text-green-600 hover:bg-green-50 px-3 py-1 rounded text-sm">
                                        <i class="fas fa-paper-plane mr-1"></i>Опубликовать
                                    </button>` :
                        `<div class="flex items-center text-green-600">
                                        <i class="fas fa-check-circle mr-1"></i>
                                        <span class="text-sm">Опубликовано</span>
                                    </div>`
                    }
                            </div>
                        </div>
                    `;
                    container.appendChild(div);
                });
            })
            .catch(error => console.error('Error loading announcements:', error));
    }

    function loadPendingUsers() {
        const container = document.getElementById('pendingUsersList');
        // Simulate loading pending users
        container.innerHTML = `
            <div class="border rounded-lg p-4 hover:shadow-md transition">
                <div class="flex justify-between items-start">
                    <div>
                        <h4 class="font-semibold">ООО "ИнноТех"</h4>
                        <p class="text-sm text-gray-600 mt-1">innotech@example.com</p>
                        <div class="flex items-center mt-2 space-x-4 text-xs text-gray-500">
                            <span><i class="fas fa-user mr-1"></i>Петров П.П.</span>
                            <span><i class="fas fa-briefcase mr-1"></i>IT-разработка</span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="approveUser(3)" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm">
                            <i class="fas fa-check mr-1"></i>Одобрить
                        </button>
                        <button onclick="rejectUser(3)" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">
                            <i class="fas fa-times mr-1"></i>Отклонить
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    function loadUsers() {
        const container = document.getElementById('usersList');
        // Simulate loading users
        container.innerHTML = `
            <div class="border rounded-lg p-4 hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <div>
                        <h4 class="font-semibold">resident1 - ИТ Компания</h4>
                        <p class="text-sm text-gray-600">resident@example.com</p>
                        <span class="px-2 py-1 text-xs rounded bg-green-100 text-green-800">Резидент</span>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editUser(1, 'resident1', 'ИТ Компания')" class="text-blue-600 hover:bg-blue-50 p-2 rounded">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteUser(1)" class="text-red-600 hover:bg-red-50 p-2 rounded">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    function loadAnalytics() {
        // Initialize analytics charts
        setTimeout(() => {
            initializeAnalyticsCharts();
        }, 100);
    }

    function initializeCharts() {
        // Room Occupancy Chart
        const roomOccupancyCtx = document.getElementById('roomOccupancyChart').getContext('2d');
        new Chart(roomOccupancyCtx, {
            type: 'bar',
            data: {
                labels: ['Переговорка', 'Конференц-зал', 'Выставочный зал'],
                datasets: [{
                    label: 'Загруженность (%)',
                    data: [75, 60, 40],
                    backgroundColor: ['#8b5cf6', '#10b981', '#f59e0b'],
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });

        // Users Chart
        const usersCtx = document.getElementById('usersChart').getContext('2d');
        new Chart(usersCtx, {
            type: 'doughnut',
            data: {
                labels: ['Резиденты', 'Пользователи', 'Администраторы'],
                datasets: [{
                    data: [24, 15, 2],
                    backgroundColor: [
                        '#667eea',
                        '#48bb78',
                        '#e53e3e'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    }

    function initializeAnalyticsCharts() {
        // Monthly Bookings Chart
        const monthlyCtx = document.getElementById('monthlyBookingsChart').getContext('2d');
        new Chart(monthlyCtx, {
            type: 'line',
            data: {
                labels: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн'],
                datasets: [{
                    label: 'Бронирования',
                    data: [65, 59, 80, 81, 56, 85],
                    borderColor: '#8b5cf6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

        // Room Popularity Chart
        const popularityCtx = document.getElementById('roomPopularityChart').getContext('2d');
        new Chart(popularityCtx, {
            type: 'pie',
            data: {
                labels: ['Переговорка', 'Конференц-зал', 'Выставочный зал'],
                datasets: [{
                    data: [45, 35, 20],
                    backgroundColor: ['#8b5cf6', '#10b981', '#f59e0b']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    }

    function loadDashboardData() {
        // Simulate recent activity
        const activityList = document.getElementById('activityList');
        activityList.innerHTML = `
            <div class="activity-item flex items-center space-x-4 p-3 hover:bg-gray-50 rounded-lg transition">
                <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-user-plus text-purple-600 text-sm"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-medium">Новая регистрация</p>
                    <p class="text-xs text-gray-500">ООО "ИнноТех" подала заявку на резидентство</p>
                </div>
                <span class="text-xs text-gray-400">5 мин назад</span>
            </div>

            <div class="activity-item flex items-center space-x-4 p-3 hover:bg-gray-50 rounded-lg transition">
                <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-red-600 text-sm"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-medium">Конфликт бронирования</p>
                    <p class="text-xs text-gray-500">Конференц-зал забронирован на одно время двумя клиентами</p>
                </div>
                <span class="text-xs text-gray-400">15 мин назад</span>
            </div>

            <div class="activity-item flex items-center space-x-4 p-3 hover:bg-gray-50 rounded-lg transition">
                <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-check text-green-600 text-sm"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-medium">Бронь подтверждена</p>
                    <p class="text-xs text-gray-500">Переговорка подтверждена для "DataSoft"</p>
                </div>
                <span class="text-xs text-gray-400">1 час назад</span>
            </div>
        `;
    }

    function loadNotifications() {
        fetch('/api/notifications')
            .then(response => response.json())
            .then(data => {
                const unreadCount = data.filter(n => !n.read).length;
                const badge = document.getElementById('notificationBadge');
                const list = document.getElementById('notificationsList');

                if (unreadCount > 0) {
                    badge.textContent = unreadCount;
                    badge.classList.remove('hidden');
                } else {
                    badge.classList.add('hidden');
                }

                list.innerHTML = '';
                if (data.length === 0) {
                    list.innerHTML = '<div class="p-4 text-gray-500 text-center">Нет уведомлений</div>';
                } else {
                    data.slice(0, 5).forEach(notification => {
                        const div = document.createElement('div');
                        div.className = `p-3 border-b ${notification.read ? 'bg-gray-50' : 'bg-blue-50'}`;
                        div.innerHTML = `
                            <div class="font-medium text-sm">${notification.title}</div>
                            <div class="text-xs text-gray-600 mt-1">${notification.message}</div>
                            <div class="text-xs text-gray-400 mt-1">${new Date(notification.createdAt).toLocaleString('ru-RU')}</div>
                        `;

                        if (!notification.read) {
                            div.addEventListener('click', () => markNotificationAsRead(notification.id));
                        }

                        list.appendChild(div);
                    });
                }
            })
            .catch(error => console.error('Error loading notifications:', error));
    }

    function markNotificationAsRead(notificationId) {
        fetch(`/api/notifications/${notificationId}/read`, { method: 'POST' })
            .then(() => loadNotifications())
            .catch(error => console.error('Error marking notification as read:', error));
    }

    function toggleNotifications() {
        const dropdown = document.getElementById('notificationsDropdown');
        dropdown.classList.toggle('hidden');
    }

    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const icon = document.getElementById('sidebarToggleIcon');

        sidebar.classList.toggle('sidebar-collapsed');

        if (sidebar.classList.contains('sidebar-collapsed')) {
            mainContent.style.marginLeft = '80px';
            icon.className = 'fas fa-chevron-right';
            document.querySelectorAll('.sidebar-text').forEach(el => el.style.display = 'none');
        } else {
            mainContent.style.marginLeft = '256px';
            icon.className = 'fas fa-chevron-left';
            setTimeout(() => {
                document.querySelectorAll('.sidebar-text').forEach(el => el.style.display = 'block');
            }, 150);
        }
    }

    // Modal functions
    function editUser(userId, username, company) {
        document.getElementById('editUserId').value = userId;
        document.getElementById('editUsername').value = username;
        document.getElementById('editPassword').value = '';
        document.getElementById('userEditModal').classList.remove('hidden');
    }

    function closeUserEditModal() {
        document.getElementById('userEditModal').classList.add('hidden');
        document.getElementById('userEditForm').reset();
    }

    function openAnnouncementModal() {
        document.getElementById('announcementModal').classList.remove('hidden');
    }

    function closeAnnouncementModal() {
        document.getElementById('announcementModal').classList.add('hidden');
        document.getElementById('announcementForm').reset();
    }

    // Form handlers
    document.getElementById('createUserForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());

        fetch('/api/admin/create-user', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
            .then(response => response.text())
            .then(result => {
                showNotification(result, 'success');
                this.reset();
                loadUsers();
            })
            .catch(error => {
                showNotification('Ошибка создания пользователя: ' + error.message, 'error');
            });
    });

    document.getElementById('userEditForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());
        const userId = data.userId;

        fetch(`/api/admin/update-user-credentials/${userId}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                username: data.username,
                password: data.password
            })
        })
            .then(response => response.text())
            .then(result => {
                showNotification(result, 'success');
                closeUserEditModal();
                loadUsers();
            })
            .catch(error => {
                showNotification('Ошибка обновления: ' + error.message, 'error');
            });
    });

    document.getElementById('announcementForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());

        fetch('/api/announcement', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(result => {
                closeAnnouncementModal();
                loadAnnouncements();
                showNotification('Объявление создано!', 'success');
            })
            .catch(error => {
                showNotification('Ошибка создания объявления: ' + error.message, 'error');
            });
    });

    // Admin functions
    function approveUser(userId) {
        fetch(`/api/admin/approve-user/${userId}`, { method: 'POST' })
            .then(response => response.text())
            .then(result => {
                loadPendingUsers();
                loadUsers();
                showNotification('Пользователь одобрен!', 'success');
            })
            .catch(error => showNotification('Ошибка одобрения: ' + error.message, 'error'));
    }

    function rejectUser(userId) {
        if (confirm('Вы уверены, что хотите отклонить этого пользователя?')) {
            fetch(`/api/admin/delete-user/${userId}`, { method: 'DELETE' })
                .then(response => response.text())
                .then(result => {
                    loadPendingUsers();
                    showNotification('Пользователь отклонен!', 'success');
                })
                .catch(error => showNotification('Ошибка отклонения: ' + error.message, 'error'));
        }
    }

    function deleteUser(userId) {
        if (confirm('Вы уверены, что хотите удалить этого пользователя?')) {
            fetch(`/api/admin/delete-user/${userId}`, { method: 'DELETE' })
                .then(response => response.text())
                .then(result => {
                    loadUsers();
                    showNotification('Пользователь удален!', 'success');
                })
                .catch(error => showNotification('Ошибка удаления: ' + error.message, 'error'));
        }
    }

    function approveBooking(bookingId) {
        fetch(`/api/admin/approve-booking/${bookingId}`, { method: 'POST' })
            .then(response => response.text())
            .then(result => {
                loadBookings();
                showNotification('Бронь одобрена!', 'success');
            })
            .catch(error => showNotification('Ошибка одобрения брони: ' + error.message, 'error'));
    }

    function rejectBooking(bookingId) {
        if (confirm('Вы уверены, что хотите отклонить эту бронь?')) {
            fetch(`/api/admin/reject-booking/${bookingId}`, { method: 'POST' })
                .then(response => response.text())
                .then(result => {
                    loadBookings();
                    showNotification('Бронь отклонена!', 'success');
                })
                .catch(error => showNotification('Ошибка отклонения брони: ' + error.message, 'error'));
        }
    }

    function publishAnnouncement(announcementId) {
        fetch(`/api/admin/publish-announcement/${announcementId}`, { method: 'POST' })
            .then(response => response.text())
            .then(result => {
                loadAnnouncements();
                showNotification('Объявление опубликовано! Резиденты получили уведомление.', 'success');
            })
            .catch(error => showNotification('Ошибка публикации: ' + error.message, 'error'));
    }

    // Notification function
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white ${
            type === 'success' ? 'bg-green-500' :
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
        } shadow-lg z-50 animate-pulse`;
        notification.innerHTML = `
            <div class="flex items-center">
                <i class="fas ${
            type === 'success' ? 'fa-check-circle' :
                type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'
        } mr-2"></i>
                ${message}
            </div>
        `;
        document.body.appendChild(notification);

        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    function logout() {
        window.location.href = '/logout';
    }

    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
        const notificationsDropdown = document.getElementById('notificationsDropdown');
        const notificationButton = e.target.closest('[onclick="toggleNotifications()"]');

        if (!notificationButton && !notificationsDropdown.contains(e.target)) {
            notificationsDropdown.classList.add('hidden');
        }
    });

    // Close modals on ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeUserEditModal();
            closeAnnouncementModal();
        }
    });
</script>
</body>
</html>